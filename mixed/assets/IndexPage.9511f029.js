import{Q as ce}from"./QSlideTransition.dc6d229c.js";import{j as W,r as x,c as h,h as g,z as de,N as ve,aP as pe,g as $,aB as fe,ai as D,a_ as me,a$ as ge,a1 as N,b0 as K,aT as H,a4 as M,a0 as R,w as he,a3 as be,aI as _e,l as E,a8 as ye,b9 as ee,as as Q,i as Ce,ba as te,u as Se,k as we,aa as xe,aA as Pe,aw as qe,bb as ne,bc as De,M as X,m as Be,o as Ie,n as Ae,I as Ee,d as B,q as I,P as ke,t as F,A as P,x as A}from"./index.13381753.js";import{g as Y,s as G}from"./touch.70a9dd44.js";import{c as Te}from"./selection.f16de754.js";import{u as j,q as Ne}from"./dialog.e7bf14fd.js";import{c as Fe}from"./config.bdffb9b8.js";import"./index.51f40b55.js";import"./index.2cf0d985.js";var ae=W({name:"StepHeader",props:{stepper:{},step:{},goToPanel:Function},setup(e,{attrs:n}){const{proxy:{$q:s}}=$(),l=x(null),r=h(()=>e.stepper.modelValue===e.step.name),t=h(()=>{const o=e.step.disable;return o===!0||o===""}),a=h(()=>{const o=e.step.error;return o===!0||o===""}),c=h(()=>{const o=e.step.done;return t.value===!1&&(o===!0||o==="")}),m=h(()=>{const o=e.step.headerNav,f=o===!0||o===""||o===void 0;return t.value===!1&&e.stepper.headerNav&&f}),p=h(()=>e.step.prefix&&(r.value===!1||e.stepper.activeIcon==="none")&&(a.value===!1||e.stepper.errorIcon==="none")&&(c.value===!1||e.stepper.doneIcon==="none")),u=h(()=>{const o=e.step.icon||e.stepper.inactiveIcon;if(r.value===!0){const f=e.step.activeIcon||e.stepper.activeIcon;return f==="none"?o:f||s.iconSet.stepper.active}if(a.value===!0){const f=e.step.errorIcon||e.stepper.errorIcon;return f==="none"?o:f||s.iconSet.stepper.error}if(t.value===!1&&c.value===!0){const f=e.step.doneIcon||e.stepper.doneIcon;return f==="none"?o:f||s.iconSet.stepper.done}return o}),v=h(()=>{const o=a.value===!0?e.step.errorColor||e.stepper.errorColor:void 0;if(r.value===!0){const f=e.step.activeColor||e.stepper.activeColor||e.step.color;return f!==void 0?f:o}return o!==void 0?o:t.value===!1&&c.value===!0?e.step.doneColor||e.stepper.doneColor||e.step.color||e.stepper.inactiveColor:e.step.color||e.stepper.inactiveColor}),i=h(()=>"q-stepper__tab col-grow flex items-center no-wrap relative-position"+(v.value!==void 0?` text-${v.value}`:"")+(a.value===!0?" q-stepper__tab--error q-stepper__tab--error-with-"+(p.value===!0?"prefix":"icon"):"")+(r.value===!0?" q-stepper__tab--active":"")+(c.value===!0?" q-stepper__tab--done":"")+(m.value===!0?" q-stepper__tab--navigation q-focusable q-hoverable":"")+(t.value===!0?" q-stepper__tab--disabled":"")),b=h(()=>e.stepper.headerNav!==!0?!1:m.value);function _(){l.value!==null&&l.value.focus(),r.value===!1&&e.goToPanel(e.step.name)}function C(o){o.keyCode===13&&r.value===!1&&e.goToPanel(e.step.name)}return()=>{const o={class:i.value};m.value===!0&&(o.onClick=_,o.onKeyup=C,Object.assign(o,t.value===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:n.tabindex||0}));const f=[g("div",{class:"q-focus-helper",tabindex:-1,ref:l}),g("div",{class:"q-stepper__dot row flex-center q-stepper__line relative-position"},[g("span",{class:"row flex-center"},[p.value===!0?e.step.prefix:g(de,{name:u.value})])])];if(e.step.title!==void 0&&e.step.title!==null){const w=[g("div",{class:"q-stepper__title"},e.step.title)];e.step.caption!==void 0&&e.step.caption!==null&&w.push(g("div",{class:"q-stepper__caption"},e.step.caption)),f.push(g("div",{class:"q-stepper__label q-stepper__line relative-position"},w))}return ve(g("div",o,f),[[pe,b.value]])}}});function Ve(e){const n=[.06,6,50];return typeof e=="string"&&e.length&&e.split(":").forEach((s,l)=>{const r=parseFloat(s);r&&(n[l]=r)}),n}var $e=fe({name:"touch-swipe",beforeMount(e,{value:n,arg:s,modifiers:l}){if(l.mouse!==!0&&D.has.touch!==!0)return;const r=l.mouseCapture===!0?"Capture":"",t={handler:n,sensitivity:Ve(s),direction:Y(l),noop:me,mouseStart(a){G(a,t)&&ge(a)&&(N(t,"temp",[[document,"mousemove","move",`notPassive${r}`],[document,"mouseup","end","notPassiveCapture"]]),t.start(a,!0))},touchStart(a){if(G(a,t)){const c=a.target;N(t,"temp",[[c,"touchmove","move","notPassiveCapture"],[c,"touchcancel","end","notPassiveCapture"],[c,"touchend","end","notPassiveCapture"]]),t.start(a)}},start(a,c){D.is.firefox===!0&&K(e,!0);const m=H(a);t.event={x:m.left,y:m.top,time:Date.now(),mouse:c===!0,dir:!1}},move(a){if(t.event===void 0)return;if(t.event.dir!==!1){M(a);return}const c=Date.now()-t.event.time;if(c===0)return;const m=H(a),p=m.left-t.event.x,u=Math.abs(p),v=m.top-t.event.y,i=Math.abs(v);if(t.event.mouse!==!0){if(u<t.sensitivity[1]&&i<t.sensitivity[1]){t.end(a);return}}else if(u<t.sensitivity[2]&&i<t.sensitivity[2])return;const b=u/c,_=i/c;t.direction.vertical===!0&&u<i&&u<100&&_>t.sensitivity[0]&&(t.event.dir=v<0?"up":"down"),t.direction.horizontal===!0&&u>i&&i<100&&b>t.sensitivity[0]&&(t.event.dir=p<0?"left":"right"),t.direction.up===!0&&u<i&&v<0&&u<100&&_>t.sensitivity[0]&&(t.event.dir="up"),t.direction.down===!0&&u<i&&v>0&&u<100&&_>t.sensitivity[0]&&(t.event.dir="down"),t.direction.left===!0&&u>i&&p<0&&i<100&&b>t.sensitivity[0]&&(t.event.dir="left"),t.direction.right===!0&&u>i&&p>0&&i<100&&b>t.sensitivity[0]&&(t.event.dir="right"),t.event.dir!==!1?(M(a),t.event.mouse===!0&&(document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),Te(),t.styleCleanup=C=>{t.styleCleanup=void 0,document.body.classList.remove("non-selectable");const o=()=>{document.body.classList.remove("no-pointer-events--children")};C===!0?setTimeout(o,50):o()}),t.handler({evt:a,touch:t.event.mouse!==!0,mouse:t.event.mouse,direction:t.event.dir,duration:c,distance:{x:u,y:i}})):t.end(a)},end(a){t.event!==void 0&&(R(t,"temp"),D.is.firefox===!0&&K(e,!1),t.styleCleanup!==void 0&&t.styleCleanup(!0),a!==void 0&&t.event.dir!==!1&&M(a),t.event=void 0)}};if(e.__qtouchswipe=t,l.mouse===!0){const a=l.mouseCapture===!0||l.mousecapture===!0?"Capture":"";N(t,"main",[[e,"mousedown","mouseStart",`passive${a}`]])}D.has.touch===!0&&N(t,"main",[[e,"touchstart","touchStart",`passive${l.capture===!0?"Capture":""}`],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,n){const s=e.__qtouchswipe;s!==void 0&&(n.oldValue!==n.value&&(typeof n.value!="function"&&s.end(),s.handler=n.value),s.direction=Y(n.modifiers))},beforeUnmount(e){const n=e.__qtouchswipe;n!==void 0&&(R(n,"main"),R(n,"temp"),D.is.firefox===!0&&K(e,!1),n.styleCleanup!==void 0&&n.styleCleanup(),delete e.__qtouchswipe)}});function re(){const e=new Map;return{getCache:function(n,s){return e[n]===void 0?e[n]=s:e[n]},getCacheWithFn:function(n,s){return e[n]===void 0?e[n]=s():e[n]}}}const Le={name:{required:!0},disable:Boolean},J={setup(e,{slots:n}){return()=>g("div",{class:"q-panel scroll",role:"tabpanel"},E(n.default))}},Ke={modelValue:{required:!0},animated:Boolean,infinite:Boolean,swipeable:Boolean,vertical:Boolean,transitionPrev:String,transitionNext:String,transitionDuration:{type:[String,Number],default:300},keepAlive:Boolean,keepAliveInclude:[String,Array,RegExp],keepAliveExclude:[String,Array,RegExp],keepAliveMax:Number},Me=["update:modelValue","beforeTransition","transition"];function Re(){const{props:e,emit:n,proxy:s}=$(),{getCacheWithFn:l}=re();let r,t;const a=x(null),c=x(null);function m(d){const y=e.vertical===!0?"up":"left";q((s.$q.lang.rtl===!0?-1:1)*(d.direction===y?1:-1))}const p=h(()=>[[$e,m,void 0,{horizontal:e.vertical!==!0,vertical:e.vertical,mouse:!0}]]),u=h(()=>e.transitionPrev||`slide-${e.vertical===!0?"down":"right"}`),v=h(()=>e.transitionNext||`slide-${e.vertical===!0?"up":"left"}`),i=h(()=>`--q-transition-duration: ${e.transitionDuration}ms`),b=h(()=>typeof e.modelValue=="string"||typeof e.modelValue=="number"?e.modelValue:String(e.modelValue)),_=h(()=>({include:e.keepAliveInclude,exclude:e.keepAliveExclude,max:e.keepAliveMax})),C=h(()=>e.keepAliveInclude!==void 0||e.keepAliveExclude!==void 0);he(()=>e.modelValue,(d,y)=>{const S=k(d)===!0?L(d):-1;t!==!0&&O(S===-1?0:S<L(y)?-1:1),a.value!==S&&(a.value=S,n("beforeTransition",d,y),ye(()=>{n("transition",d,y)}))});function o(){q(1)}function f(){q(-1)}function w(d){n("update:modelValue",d)}function k(d){return d!=null&&d!==""}function L(d){return r.findIndex(y=>y.props.name===d&&y.props.disable!==""&&y.props.disable!==!0)}function ue(){return r.filter(d=>d.props.disable!==""&&d.props.disable!==!0)}function O(d){const y=d!==0&&e.animated===!0&&a.value!==-1?"q-transition--"+(d===-1?u.value:v.value):null;c.value!==y&&(c.value=y)}function q(d,y=a.value){let S=y+d;for(;S>-1&&S<r.length;){const T=r[S];if(T!==void 0&&T.props.disable!==""&&T.props.disable!==!0){O(d),t=!0,n("update:modelValue",T.props.name),setTimeout(()=>{t=!1});return}S+=d}e.infinite===!0&&r.length>0&&y!==-1&&y!==r.length&&q(d,d===-1?r.length:-1)}function U(){const d=L(e.modelValue);return a.value!==d&&(a.value=d),!0}function z(){const d=k(e.modelValue)===!0&&U()&&r[a.value];return e.keepAlive===!0?[g(ee,_.value,[g(C.value===!0?l(b.value,()=>({...J,name:b.value})):J,{key:b.value,style:i.value},()=>d)])]:[g("div",{class:"q-panel scroll",style:i.value,key:b.value,role:"tabpanel"},[d])]}function ie(){if(r.length!==0)return e.animated===!0?[g(be,{name:c.value},z)]:z()}function se(d){return r=_e(E(d.default,[])).filter(y=>y.props!==null&&y.props.slot===void 0&&k(y.props.name)===!0),r.length}function le(){return r}return Object.assign(s,{next:o,previous:f,goTo:w}),{panelIndex:a,panelDirectives:p,updatePanelsList:se,updatePanelIndex:U,getPanelContent:ie,getEnabledPanels:ue,getPanels:le,isValidPanelName:k,keepAliveProps:_,needsUniqueKeepAliveWrapper:C,goToPanelByOffset:q,goToPanel:w,nextPanel:o,previousPanel:f}}function oe(e){return g("div",{class:"q-stepper__step-content"},[g("div",{class:"q-stepper__step-inner"},E(e.default))])}const Z={setup(e,{slots:n}){return()=>oe(n)}};var V=W({name:"QStep",props:{...Le,icon:String,color:String,title:{type:String,required:!0},caption:String,prefix:[String,Number],doneIcon:String,doneColor:String,activeIcon:String,activeColor:String,errorIcon:String,errorColor:String,headerNav:{type:Boolean,default:!0},done:Boolean,error:Boolean,onScroll:[Function,Array]},setup(e,{slots:n,emit:s}){const{proxy:{$q:l}}=$(),r=Ce(te,Q);if(r===Q)return console.error("QStep needs to be a child of QStepper"),Q;const{getCacheWithFn:t}=re(),a=x(null),c=h(()=>r.value.modelValue===e.name),m=h(()=>l.platform.is.ios!==!0&&l.platform.is.chrome===!0||c.value!==!0||r.value.vertical!==!0?{}:{onScroll(v){const{target:i}=v;i.scrollTop>0&&(i.scrollTop=0),e.onScroll!==void 0&&s("scroll",v)}}),p=h(()=>typeof e.name=="string"||typeof e.name=="number"?e.name:String(e.name));function u(){const v=r.value.vertical;return v===!0&&r.value.keepAlive===!0?g(ee,r.value.keepAliveProps.value,c.value===!0?[g(r.value.needsUniqueKeepAliveWrapper.value===!0?t(p.value,()=>({...Z,name:p.value})):Z,{key:p.value},n.default)]:void 0):v!==!0||c.value===!0?oe(n):void 0}return()=>g("div",{ref:a,class:"q-stepper__step",role:"tabpanel",...m.value},r.value.vertical===!0?[g(ae,{stepper:r.value,step:e,goToPanel:r.value.goToPanel}),r.value.animated===!0?g(ce,u):u()]:[u()])}});const Qe=/(-\w)/g;function We(e){const n={};for(const s in e){const l=s.replace(Qe,r=>r[1].toUpperCase());n[l]=e[s]}return n}var je=W({name:"QStepper",props:{...Se,...Ke,flat:Boolean,bordered:Boolean,alternativeLabels:Boolean,headerNav:Boolean,contracted:Boolean,headerClass:String,inactiveColor:String,inactiveIcon:String,doneIcon:String,doneColor:String,activeIcon:String,activeColor:String,errorIcon:String,errorColor:String},emits:Me,setup(e,{slots:n}){const s=$(),l=we(e,s.proxy.$q),{updatePanelsList:r,isValidPanelName:t,updatePanelIndex:a,getPanelContent:c,getPanels:m,panelDirectives:p,goToPanel:u,keepAliveProps:v,needsUniqueKeepAliveWrapper:i}=Re();xe(te,h(()=>({goToPanel:u,keepAliveProps:v,needsUniqueKeepAliveWrapper:i,...e})));const b=h(()=>`q-stepper q-stepper--${e.vertical===!0?"vertical":"horizontal"}`+(e.flat===!0||l.value===!0?" q-stepper--flat no-shadow":"")+(e.bordered===!0||l.value===!0&&e.flat===!1?" q-stepper--bordered":"")+(l.value===!0?" q-stepper--dark q-dark":"")),_=h(()=>`q-stepper__header row items-stretch justify-between q-stepper__header--${e.alternativeLabels===!0?"alternative":"standard"}-labels`+(e.flat===!1||e.bordered===!0?" q-stepper__header--border":"")+(e.contracted===!0?" q-stepper__header--contracted":"")+(e.headerClass!==void 0?` ${e.headerClass}`:""));function C(){const o=E(n.message,[]);if(e.vertical===!0){t(e.modelValue)&&a();const f=g("div",{class:"q-stepper__content"},E(n.default));return o===void 0?[f]:o.concat(f)}return[g("div",{class:_.value},m().map(f=>{const w=We(f.props);return g(ae,{key:w.name,stepper:e,step:w,goToPanel:u})})),o,qe("div",{class:"q-stepper__content q-panel-parent"},c(),"cont",e.swipeable,()=>p.value)]}return()=>(r(n),g("div",{class:b.value},Pe(n.navigation,C())))}});const Oe=function(){const e=Fe.lottery,n=j(),{data:s}=ne(n),l=function(){window.indexedDB&&window.indexedDB.deleteDatabase(e.db.name)},r=function(){return new Promise((a,c)=>{if(window.indexedDB){const m=window.indexedDB.open(e.db.name,e.db.ver);m.onsuccess=function(p){var v,i;const u=p.target.result;Promise.all([t(u,e.db.store.award,(v=s.value)==null?void 0:v.type),t(u,e.db.store.user,(i=s.value)==null?void 0:i.userData)]).then(b=>{a(b)}).catch(b=>{c(b)})},m.onerror=function(p){c(p)},m.onupgradeneeded=function(p){const u=p.target.result;u.objectStoreNames.contains(e.db.store.user)||u.createObjectStore(e.db.store.user,{keyPath:"CompleteID"}),u.objectStoreNames.contains(e.db.store.award)||u.createObjectStore(e.db.store.award,{autoIncrement:!0})}}else Ne("\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301IndexedDB\u6570\u636E\u5E93\u3002"),c()})},t=function(a,c,m){return new Promise((p,u)=>{let v=0;const i=a.transaction(c,"readwrite");i.oncomplete=function(){p(v)},i.onerror=function(_){u(_)};const b=i.objectStore(c);for(const _ of m){const C=b.add(De(_));C.onsuccess=function(){v++},C.onerror=function(o){u(o)}}})};return{deleteDB:l,initDB:r}},Ue=function(e){const n=j(),{data:s}=ne(n),l=x(0),r=x(0),t=X({title:"",status:"wait",description:"\u6821\u9A8C\u6570\u636E\u662F\u5426\u4E00\u81F4"}),a=X({show:!1,tips:"3"});return{data:s,step:t,stop:a,userNum:r,catchImg:l,preLoadImg:async function(){return new Promise((p,u)=>{var i;const v=((i=s.value)==null?void 0:i.userData)||[];for(const b of v){const _=new Image;_.src=b.HeadImg,_.addEventListener("load",()=>{l.value++,l.value===v.length&&p(l.value)},!1),_.addEventListener("error",C=>{u(C)},!1)}})},validateData:function(){return new Promise((p,u)=>{if(l.value===r.value&&l.value===e.value){t.title="\u6210\u529F",t.status="success",t.description="3\u79D2\u540E\u8FDB\u5165\u62BD\u5956\u9875\u9762",a.show=!0;let v=3;const i=setInterval(()=>{if(v--,v===2)a.tips="2";else if(v===1)a.tips="1";else return clearInterval(i),p(v)},1e3)}else u(new Error("\u6570\u636E\u6821\u9A8C\u5931\u8D25"))})}}},ze={class:"q-pa-md"},nt=Be({__name:"IndexPage",setup(e){const n=x(0),s=x(0),l=ke(),r=j(),{deleteDB:t,initDB:a}=Oe(),{data:c,step:m,stop:p,userNum:u,catchImg:v,preLoadImg:i,validateData:b}=Ue(s),_=async function(){var C;try{await r.getDatas(),u.value=(((C=c.value)==null?void 0:C.userData)||[]).length,n.value=1,t();const[o,f]=await a();if(!o||!f)throw new Error("\u521D\u59CB\u5316database\u5931\u8D25");s.value=f,n.value=2,await i(),n.value=3,await b(),l.push({path:"raffle"})}catch(o){console.log("onload ==> error",o),m.title="\u5931\u8D25",m.status="error",m.description="\u8BF7\u91CD\u65B0\u8FDB\u5165\u6216\u8005 \u5237\u65B0\u672C\u9875\u9762"}};return Ie(()=>{_()}),(C,o)=>(Ae(),Ee("div",ze,[B(je,{modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=f=>n.value=f),vertical:"",animated:""},{default:I(()=>[B(V,{name:0,title:"\u6570\u636E\u83B7\u53D6",icon:"settings",done:n.value>0},{default:I(()=>[F(" \u5171\u8BA1\u83B7\u53D6 "+P(A(u))+" \u6761 ",1)]),_:1},8,["done"]),B(V,{name:1,title:"\u5B58\u50A8\u6570\u636E",caption:"Optional",icon:"create_new_folder",done:n.value>1},{default:I(()=>[F(" \u5171\u8BA1\u63D2\u5165"+P(s.value)+"\u6761 ",1)]),_:1},8,["done"]),B(V,{name:2,title:"\u7F13\u5B58\u5934\u50CF",caption:"Optional",icon:"create_new_folder",done:n.value>1},{default:I(()=>[F(" \u5171\u8BA1\u7F13\u5B58 "+P(A(v))+"\u5F20 ",1)]),_:1},8,["done"]),B(V,{name:3,title:"\u6570\u636E\u6821\u9A8C",icon:"add_comment"},{default:I(()=>[F(" \u6570\u636E\u6821\u9A8C"+P(A(m).title)+"/"+P(A(m).description)+"\uFF1A"+P(A(p).tips),1)]),_:1})]),_:1},8,["modelValue"])]))}});export{nt as default};
